{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport getUserAddress from '@/api/getUserAddress';\nimport PerAddress from '@/user/PerAddress.vue';\nimport sendOrder from '@/api/postOrderCommodity';\nimport { nanoid } from 'nanoid';\nimport getTime from '../utils/get_time';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'BeSure',\n  components: {\n    PerAddress\n  },\n  data() {\n    return {\n      singel: false,\n      visible: false,\n      confirmAddress: '',\n      address: '',\n      currentRow: null\n    };\n  },\n  methods: {\n    getConfirmAddress(data) {\n      this.confirmAddress = data;\n    },\n    handleCurrentChange(val) {\n      this.currentRow = val;\n    },\n    sendCurrent() {\n      if (!this.currentRow) {\n        this.$message({\n          showClose: true,\n          message: '您还未确认地址哟~',\n          type: 'error'\n        });\n        return 0;\n      }\n      this.visible = false;\n      this.confirmAddress = this.currentRow.id;\n      this.goResult();\n    },\n    goResult() {\n      const address = this.address.filter(item => {\n        return item.id == this.confirmAddress;\n      });\n      console.log(this.confirmAddress);\n      if (!this.confirmAddress) {\n        this.visible = true;\n        console.log(this.visible);\n        return 0;\n      }\n      const orderData = {\n        order_id: nanoid(),\n        u_id: '',\n        time: getTime(),\n        number: nanoid(),\n        // price:this.getTotalPrice,\n        // shopping:this.checkedShoppingCart,\n        address: address\n      };\n      // this.$store.dispatch('user/unshiftPayedShoppingCart',orderData)\n      //       const senItem  = function(){\n      //         sendOrder(orderData).then(res=>{\n\n      // })\n      //       }\n      this.singel = true;\n      // this.getPay = true\n      this.$store.commit('cart/resetShoppingCart');\n      const shopping = this.checkedShoppingCart;\n      shopping.forEach(item => {});\n    },\n    toPerOrder() {\n      this.$router.push({\n        name: 'perorder',\n        params: {\n          bread: '我的订单'\n        }\n      });\n    },\n    backHome() {\n      this.$router.push({\n        name: 'home'\n      });\n    }\n  },\n  // watch:{\n  //   getPay(){\n  //     this.payResult.get()\n  //   }\n  // },\n  computed: {\n    ...mapGetters('cart', ['getTotalPrice', 'checkedNumber', 'checkedShoppingCart'])\n    // payResult:{\n    //   get(val){\n    //     return this.getPay == val ? '已结算' : '结算'\n    //   }\n    // }\n  },\n\n  async created() {\n    await getUserAddress().then(res => {\n      this.address = res.data;\n    });\n  },\n  mounted() {\n    console.log(this.confirmAddress);\n  },\n  beforeDestroy() {\n    this.$off('getConfirmAddress');\n  }\n\n  // beforeRouteEnter(to,from,next){\n  //   sessionStorage.getItem('login')==='true' ? next() : confirm('请先登录')\n  // },\n};","map":{"version":3,"names":["getUserAddress","PerAddress","sendOrder","nanoid","getTime","mapGetters","name","components","data","singel","visible","confirmAddress","address","currentRow","methods","getConfirmAddress","handleCurrentChange","val","sendCurrent","$message","showClose","message","type","id","goResult","filter","item","console","log","orderData","order_id","u_id","time","number","$store","commit","shopping","checkedShoppingCart","forEach","toPerOrder","$router","push","params","bread","backHome","computed","created","then","res","mounted","beforeDestroy","$off"],"sources":["src/store_bus/BeSure.vue"],"sourcesContent":["<template>\r\n  <!-- 确认订单页面 -->\r\n    <div class=\"confirmOrder\">\r\n      <!-- 头部 -->\r\n      <div class=\"confirmOrder-header\">\r\n        <div class=\"header-content\">\r\n          <p>\r\n            <i class=\"el-icon-s-order\"></i>\r\n          </p>\r\n          <p>确认订单</p>\r\n          <!-- <router-link to></router-link> -->\r\n        </div>\r\n      </div>\r\n      <!-- 头部END -->\r\n  \r\n      <!-- 主要内容容器 -->\r\n      <div class=\"content\">\r\n        <!-- 选择地址 在user里 -->\r\n        <PerAddress @getConfirmAddress=\"getConfirmAddress\"></PerAddress>\r\n        <!-- 选择地址END -->\r\n        <!-- 商品及优惠券 -->\r\n        <div class=\"section-goods\">\r\n          <p class=\"titleleft\">商品及优惠券</p>\r\n          <div class=\"goods-list\">\r\n            <ul>\r\n              <!-- <li>111</li>\r\n              <li>222</li> -->\r\n              <li v-for=\"item in checkedShoppingCart\" :key=\"item.id\">\r\n                <img :src=item.img>\r\n                <span class=\"pro-name\">{{item.title}}</span>\r\n                <span class=\"pro-price\">{{item.price}}元 x {{item.number}}</span>\r\n                <span class=\"pro-status\"></span>\r\n                <span class=\"pro-total\">{{item.price * item.number}}元</span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n        <!-- 商品及优惠券END -->\r\n  \r\n        <!-- 配送方式 -->\r\n        <div class=\"section-shipment\">\r\n          <p class=\"titleleft\">配送方式</p>\r\n          <p class=\"shipment\">包邮</p>\r\n        </div>\r\n        <!-- 配送方式END -->\r\n  \r\n        <!-- 发票 -->\r\n        <div class=\"section-invoice\">\r\n          <p class=\"titleleft\">发票</p>\r\n          <p class=\"invoice\">电子发票</p>\r\n          <p class=\"invoice\">个人</p>\r\n          <p class=\"invoice\">商品明细</p>\r\n        </div>\r\n        <!-- 发票END -->\r\n  \r\n        <!-- 结算列表 -->\r\n        <div class=\"section-count\">\r\n          <div class=\"money-box\">\r\n            <ul>\r\n              <li>\r\n                <span class=\"titleleft\">商品件数：</span>\r\n                <!-- <span class=\"value\">{{getCheckNum}}件</span> -->\r\n                <span class=\"value\"> {{checkedNumber}} </span>\r\n              </li>\r\n              <li>\r\n                <span class=\"titleleft\">商品总价：</span>\r\n                <!-- <span class=\"value\">{{getTotalPrice}}元</span> -->\r\n                <span class=\"value\">{{getTotalPrice}}</span>\r\n              </li>\r\n              <li>\r\n                <span class=\"titleleft\">活动优惠：</span>\r\n                <span class=\"value\">-0元</span>\r\n              </li>\r\n              <li>\r\n                <span class=\"titleleft\">优惠券抵扣：</span>\r\n                <span class=\"value\">-0元</span>\r\n              </li>\r\n              <li>\r\n                <span class=\"titleleft\">运费：</span>\r\n                <span class=\"value\">0元</span>\r\n              </li>\r\n              <li class=\"total\">\r\n                <span class=\"titleleft\">应付总额：</span>\r\n                <span class=\"value\">\r\n                  <!-- <span class=\"total-price\">{{getTotalPrice}}</span>元 -->\r\n                  <span class=\"total-price\">{{ getTotalPrice }}</span>元\r\n                </span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n        <!-- 结算列表END -->\r\n  \r\n        <!-- 结算导航 -->\r\n        <div class=\"section-bar\">\r\n          <div class=\"btn\">\r\n            <router-link :to=\"{name:'bus'}\" class=\"btn-base btn-return\">返回购物车</router-link>\r\n            <!-- <a href=\"javascript:void(0);\" @click=\"addOrder\" class=\"btn-base btn-primary\">结算</a> -->\r\n            <a href=\"javascript:void(0);\" class=\"btn-base btn-primary\" @click=\"goResult\">提交订单</a>\r\n          </div>\r\n        </div>\r\n        <!-- 确定选择收货地址 -->\r\n        <div class=\"address_choose\">\r\n          <el-dialog title=\"确定收货地址\" :visible.sync=\"visible\">\r\n            <el-table :data=\"address\" highlight-current-row @current-change=\"handleCurrentChange\">\r\n                <el-table-column width=\"200\" property=\"contact_personnel\" label=\"姓名\"></el-table-column>\r\n                <el-table-column  property=\"contact_phone\" label=\"电话\"></el-table-column>\r\n                <el-table-column  property=\"address\" label=\"地址\"></el-table-column>\r\n            </el-table>\r\n            <div style=\"margin-top: 20px\">\r\n              <el-button @click=\"visible = false\">取消</el-button>\r\n              <el-button style=\"margin-left: 20px\" @click=\"sendCurrent\" :style=\"(currentRow!=null) ? {backgroundColor:'#409EFF',color:'white'} : ''\">确定</el-button>\r\n            </div>\r\n          </el-dialog>\r\n        </div>\r\n        <!-- 结算导航END -->\r\n        <el-dialog :visible.sync=\"singel\">\r\n            <el-result icon=\"success\" title=\"订单提交成功\" subTitle=\"请根据提示进行操作\">\r\n              <template slot=\"extra\">\r\n                  <el-button type=\"\" size=\"medium\" @click=\"toPerOrder\">查看我的订单</el-button>\r\n                  <el-button type=\"primary\" size=\"medium\" @click=\"backHome\">返回</el-button>\r\n              </template>\r\n            </el-result>\r\n        </el-dialog>\r\n      </div>\r\n      <!-- 主要内容容器END -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport getUserAddress from '@/api/getUserAddress';\r\nimport PerAddress from '@/user/PerAddress.vue';\r\nimport sendOrder from '@/api/postOrderCommodity';\r\nimport {nanoid} from 'nanoid'\r\nimport getTime from '../utils/get_time'\r\nimport {mapGetters} from 'vuex';\r\n\r\nexport default {\r\n  name:'BeSure',\r\n  components:{PerAddress},\r\n  data() {\r\n    return{\r\n      singel:false,\r\n      visible:false,\r\n      confirmAddress:'',\r\n      address:'',\r\n      currentRow: null\r\n    }\r\n  },\r\n  methods:{\r\n    getConfirmAddress(data){\r\n      this.confirmAddress = data\r\n    },\r\n    handleCurrentChange(val) {\r\n      this.currentRow = val;\r\n    },\r\n    sendCurrent(){\r\n      if(!this.currentRow){\r\n        this.$message({\r\n          showClose: true,\r\n          message: '您还未确认地址哟~',\r\n          type: 'error'\r\n          });\r\n          return 0 \r\n      }\r\n      this.visible = false\r\n      this.confirmAddress = this.currentRow.id\r\n      this.goResult()\r\n    },\r\n    goResult(){\r\n      const address = this.address.filter((item) => {\r\n        return item.id == this.confirmAddress\r\n      })\r\n      console.log(this.confirmAddress);\r\n      if(!this.confirmAddress){\r\n        this.visible = true\r\n        console.log(this.visible);\r\n        return 0 \r\n      }\r\n      const orderData = {\r\n        order_id:nanoid(),\r\n        u_id:'',\r\n        time:getTime(),\r\n        number:nanoid(),\r\n        // price:this.getTotalPrice,\r\n        // shopping:this.checkedShoppingCart,\r\n        address:address\r\n      }\r\n      // this.$store.dispatch('user/unshiftPayedShoppingCart',orderData)\r\n//       const senItem  = function(){\r\n//         sendOrder(orderData).then(res=>{\r\n\r\n// })\r\n//       }\r\n      this.singel = true\r\n      // this.getPay = true\r\n      this.$store.commit('cart/resetShoppingCart')\r\n      const shopping = this.checkedShoppingCart\r\n      shopping.forEach((item)=>{\r\n\r\n      })\r\n    },\r\n    toPerOrder(){\r\n      this.$router.push({name:'perorder',params:{bread:'我的订单'}})\r\n    },\r\n    backHome(){\r\n      this.$router.push({name:'home'})\r\n    }\r\n  },\r\n  // watch:{\r\n  //   getPay(){\r\n  //     this.payResult.get()\r\n  //   }\r\n  // },\r\n  computed:{\r\n    ...mapGetters('cart',['getTotalPrice','checkedNumber','checkedShoppingCart']),\r\n    // payResult:{\r\n    //   get(val){\r\n    //     return this.getPay == val ? '已结算' : '结算'\r\n    //   }\r\n    // }\r\n  },\r\n  async created(){\r\n    await getUserAddress().then(res=>{\r\n      this.address = res.data\r\n    })\r\n  },\r\n  mounted(){\r\n    console.log(this.confirmAddress);\r\n  },\r\n  beforeDestroy(){\r\n    this.$off('getConfirmAddress')\r\n  }\r\n\r\n  // beforeRouteEnter(to,from,next){\r\n  //   sessionStorage.getItem('login')==='true' ? next() : confirm('请先登录')\r\n  // },\r\n}\r\n</script>\r\n<style scoped>\r\n/* 这里需要覆盖原组件的部分样式 */\r\n.section-address {\r\n  margin: 0 48px;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder {\r\n  background-color: #f5f5f5;\r\n  padding-bottom: 120px;    \r\n}\r\n/* 头部CSS */\r\n.confirmOrder .confirmOrder-header {\r\n  background-color: #fff;\r\n  border-bottom: 2px solid #ff6700;\r\n  margin-bottom: 20px;\r\n}\r\n.confirmOrder .confirmOrder-header .header-content {\r\n  width: 1100px;\r\n  margin: 0 auto;\r\n  height: 80px;\r\n}\r\n.confirmOrder .confirmOrder-header .header-content p {\r\n  float: left;\r\n  font-size: 28px;\r\n  line-height: 80px;\r\n  color: #424242;\r\n  margin-right: 20px;\r\n}\r\n.confirmOrder .confirmOrder-header .header-content p i {\r\n  font-size: 45px;\r\n  color: #3f72ad;\r\n  line-height: 80px;\r\n}\r\n/* 头部CSS END */\r\n\r\n/* 主要内容容器CSS */\r\n.confirmOrder .content {\r\n  width: 1225px;\r\n  margin: 0 auto;\r\n  padding: 48px 0 0;\r\n  background-color: #fff;\r\n}\r\n\r\n/* 商品及优惠券CSS */\r\n.confirmOrder .content .section-goods {\r\n  margin: 0 48px;\r\n  overflow: hidden;\r\n  text-align: left;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n\r\n.confirmOrder .content .section-goods p.titleleft {\r\n  color: #333;\r\n  font-size: 18px;\r\n  line-height: 40px;\r\n}\r\n.confirmOrder .content .section-goods .goods-list {\r\n  padding: 5px 0;\r\n  border-bottom: 1px solid #e0e0e0;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li {\r\n  padding: 10px 0;\r\n  color: #424242;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li img {\r\n  float: left;\r\n  width: 46px;\r\n  height: 46px;\r\n  margin-right: 10px;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li .pro-name {\r\n  float: left;\r\n  width: 650px;\r\n  line-height: 30px;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li .pro-price {\r\n  float: left;\r\n  width: 150px;\r\n  text-align: center;\r\n  line-height: 30px;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li .pro-status {\r\n  float: left;\r\n  width: 83px;\r\n  height: 30px;\r\n  text-align: center;\r\n  line-height: 30px;\r\n}\r\n.confirmOrder .content .section-goods .goods-list li .pro-total {\r\n  float: left;\r\n  width: 190px;\r\n  text-align: center;\r\n  color: #d33a31;\r\n  line-height: 30px;\r\n}\r\n/* 商品及优惠券CSS END\r\n\r\n/* 配送方式CSS */\r\n.confirmOrder .content .section-shipment {\r\n  margin: 0 48px;\r\n  padding: 25px 0;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder .content .section-shipment .titleleft {\r\n  float: left;\r\n  width: 150px;\r\n  color: #333;\r\n  text-align: left;\r\n  font-size: 18px;\r\n  line-height: 38px;\r\n}\r\n.confirmOrder .content .section-shipment .shipment {\r\n  float: left;\r\n  line-height: 38px;\r\n  font-size: 14px;\r\n  color: #d33a31;\r\n}\r\n/* 配送方式CSS END */\r\n\r\n/* 发票CSS */\r\n.confirmOrder .content .section-invoice {\r\n  margin: 0 48px;\r\n  padding: 25px 0;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder .content .section-invoice .titleleft {\r\n  float: left;\r\n  text-align: left;\r\n  width: 150px;\r\n  color: #333;\r\n  font-size: 18px;\r\n  line-height: 38px;\r\n}\r\n.confirmOrder .content .section-invoice .invoice {\r\n  float: left;\r\n  line-height: 38px;\r\n  font-size: 14px;\r\n  margin-right: 20px;\r\n  color: #d33a31;\r\n}\r\n/* 发票CSS END */\r\n\r\n/* 结算列表CSS */\r\n.confirmOrder .content .section-count {\r\n  margin: 0 48px;\r\n  padding: 20px 0;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder .content .section-count .money-box {\r\n  float: right;\r\n  text-align: right;\r\n}\r\n.confirmOrder .content .section-count .money-box .titleleft {\r\n  float: left;\r\n  width: 126px;\r\n  height: 30px;\r\n  display: block;\r\n  line-height: 30px;\r\n  color: #757575;\r\n}\r\n.confirmOrder .content .section-count .money-box .value {\r\n  float: right;\r\n  min-width: 105px;\r\n  height: 30px;\r\n  display: block;\r\n  line-height: 30px;\r\n  color: #d33a31;\r\n}\r\n.confirmOrder .content .section-count .money-box .total .titleleft {\r\n  padding-top: 15px;\r\n}\r\n.confirmOrder .content .section-count .money-box .total .value {\r\n  padding-top: 10px;\r\n}\r\n.confirmOrder .content .section-count .money-box .total-price {\r\n  font-size: 30px;\r\n}\r\n/* 结算列表CSS END */\r\n\r\n/* 结算导航CSS */\r\n.confirmOrder .content .section-bar {\r\n  padding: 20px 48px;\r\n  border-top: 2px solid #f5f5f5;\r\n  overflow: hidden;\r\n}\r\n.confirmOrder .content .address_choose{\r\n  border: 1px solid #e0e0e0;\r\n}\r\n.confirmOrder .content .section-bar .btn {\r\n  float: right;\r\n}\r\n.confirmOrder .content .section-bar .btn .btn-base {\r\n  float: left;\r\n  margin-left: 30px;\r\n  width: 158px;\r\n  height: 38px;\r\n  border: 1px solid #b0b0b0;\r\n  font-size: 14px;\r\n  line-height: 38px;\r\n  text-align: center;\r\n}\r\n.confirmOrder .content .section-bar .btn .btn-return {\r\n  color: rgba(0, 0, 0, 0.27);\r\n  border-color: rgba(0, 0, 0, 0.27);\r\n}\r\n.confirmOrder .content .section-bar .btn .btn-primary {\r\n  background: #d33a31;\r\n  border-color: #d33a31;\r\n  color: #fff;\r\n}\r\n\r\n</style>"],"mappings":";AAkIA,OAAAA,cAAA;AACA,OAAAC,UAAA;AACA,OAAAC,SAAA;AACA,SAAAC,MAAA;AACA,OAAAC,OAAA;AACA,SAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IAAAN;EAAA;EACAO,KAAA;IACA;MACAC,MAAA;MACAC,OAAA;MACAC,cAAA;MACAC,OAAA;MACAC,UAAA;IACA;EACA;EACAC,OAAA;IACAC,kBAAAP,IAAA;MACA,KAAAG,cAAA,GAAAH,IAAA;IACA;IACAQ,oBAAAC,GAAA;MACA,KAAAJ,UAAA,GAAAI,GAAA;IACA;IACAC,YAAA;MACA,UAAAL,UAAA;QACA,KAAAM,QAAA;UACAC,SAAA;UACAC,OAAA;UACAC,IAAA;QACA;QACA;MACA;MACA,KAAAZ,OAAA;MACA,KAAAC,cAAA,QAAAE,UAAA,CAAAU,EAAA;MACA,KAAAC,QAAA;IACA;IACAA,SAAA;MACA,MAAAZ,OAAA,QAAAA,OAAA,CAAAa,MAAA,CAAAC,IAAA;QACA,OAAAA,IAAA,CAAAH,EAAA,SAAAZ,cAAA;MACA;MACAgB,OAAA,CAAAC,GAAA,MAAAjB,cAAA;MACA,UAAAA,cAAA;QACA,KAAAD,OAAA;QACAiB,OAAA,CAAAC,GAAA,MAAAlB,OAAA;QACA;MACA;MACA,MAAAmB,SAAA;QACAC,QAAA,EAAA3B,MAAA;QACA4B,IAAA;QACAC,IAAA,EAAA5B,OAAA;QACA6B,MAAA,EAAA9B,MAAA;QACA;QACA;QACAS,OAAA,EAAAA;MACA;MACA;MACA;MACA;;MAEA;MACA;MACA,KAAAH,MAAA;MACA;MACA,KAAAyB,MAAA,CAAAC,MAAA;MACA,MAAAC,QAAA,QAAAC,mBAAA;MACAD,QAAA,CAAAE,OAAA,CAAAZ,IAAA,KAEA;IACA;IACAa,WAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;QAAAnC,IAAA;QAAAoC,MAAA;UAAAC,KAAA;QAAA;MAAA;IACA;IACAC,SAAA;MACA,KAAAJ,OAAA,CAAAC,IAAA;QAAAnC,IAAA;MAAA;IACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAuC,QAAA;IACA,GAAAxC,UAAA;IACA;IACA;IACA;IACA;IACA;EACA;;EACA,MAAAyC,QAAA;IACA,MAAA9C,cAAA,GAAA+C,IAAA,CAAAC,GAAA;MACA,KAAApC,OAAA,GAAAoC,GAAA,CAAAxC,IAAA;IACA;EACA;EACAyC,QAAA;IACAtB,OAAA,CAAAC,GAAA,MAAAjB,cAAA;EACA;EACAuC,cAAA;IACA,KAAAC,IAAA;EACA;;EAEA;EACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}